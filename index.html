<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador OPE Pinche</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <div class="container">
        <!-- VISTA: SELECCI√ìN DE ROL (Inicio) -->
        <div id="view-role-selection" class="view active">
            <h1>Simulador OPE SESCAM</h1>
            <p class="subtitle">Elige tu categor√≠a profesional</p>

            <div class="menu-grid">
                <button id="btn-role-pinche" class="btn-menu special">
                    üç≥ Ayudante de Cocina (Pinche)
                    <span class="badge">Disponible</span>
                </button>
                <button id="btn-role-celador" class="btn-menu">
                    üöë Celador
                    <span class="badge" style="background:var(--text-light); color:white;">Pr√≥ximamente</span>
                </button>
            </div>
            <p style="text-align:center; margin-top:40px; color:#aaa; font-size:0.9rem;">
                v1.12.1 (HOTFIX CSIF) - M√°s categor√≠as en desarrollo
            </p>
        </div>

        <!-- VISTA: MEN√ö PRINCIPAL (Pinche) -->
        <div id="view-menu" class="view hidden">
            <button id="btn-back-menu" class="btn-icon" style="position:absolute; left:20px; top:20px;">‚¨Ö</button>
            <h1 style="margin-top:20px;">Simulador OPE Pinche</h1>
            <p class="subtitle">Selecciona una fuente de estudio</p>

            <div class="menu-grid">
                <!-- Nivel Maestro: Selecci√≥n de Fuente -->
                <button id="btn-source-mad" class="btn-menu">
                    üìö Tests MAD
                    <span class="badge">Oficiales</span>
                </button>
                <button id="btn-source-csif" class="btn-menu">
                    üè• Tests CSIF
                    <span class="badge">Espec√≠ficos</span>
                </button>
                <button id="btn-source-academia" class="btn-menu">
                    üéì Tests Academia
                    <span class="badge">Pronto</span>
                </button>
                <button id="btn-source-examenes" class="btn-menu special">
                    üìÖ Ex√°menes A√±os Anteriores
                    <span class="badge">Reales</span>
                </button>

                <!-- Otras Funciones -->
                <button id="btn-failures" class="btn-menu special-red" style="grid-column: 1 / -1;">
                    üß† Repasar Fallos
                    <span class="badge" id="badge-failures">0</span>
                </button>
                <button id="btn-random" class="btn-menu">
                    üé≤ Modo Aleatorio
                    <span class="badge">Global</span>
                </button>
                <button id="btn-progress" class="btn-menu">
                    üìä Mi Progreso
                    <span class="badge">Estad√≠sticas</span>
                </button>
            </div>
            <p style="text-align:center; color:#999; margin-top:20px; font-size:0.8rem;">M√°s funciones pr√≥ximamente...
            </p>
        </div>

        <!-- VISTA: SELECCI√ìN DE PARTE (General / Espec√≠fica) -->
        <div id="view-parts" class="view hidden">
            <header class="view-header">
                <button id="btn-back-parts" class="btn-icon">‚¨Ö</button>
                <h2 id="parts-title">Fuente Seleccionada</h2>
            </header>

            <div class="menu-grid">
                <button id="btn-part-general" class="btn-menu">
                    üìö Parte General
                    <span class="badge">Temas 1 al 6</span>
                </button>
                <button id="btn-part-especifica" class="btn-menu">
                    üè• Parte Espec√≠fica
                    <span class="badge">Temas 7 al 16</span>
                </button>
            </div>
        </div>

        <!-- VISTA: MEN√ö EX√ÅMENES OPE 2020 -->
        <div id="view-exams-menu" class="view hidden">
            <header class="view-header">
                <button id="btn-back-exams" class="btn-icon">‚¨Ö</button>
                <h2>Ex√°menes A√±os Anteriores</h2>
            </header>

            <h3
                style="text-align:center; color:#6200ea; margin-top:20px; border-bottom: 2px solid #eee; padding-bottom: 10px;">
                OPE SESCAM 2020</h3>

            <div class="menu-grid">
                <button id="btn-2020-ord" class="btn-menu">
                    üìÖ Examen Ordinario
                    <span class="badge">OPE 2020 (Examen 2021)</span>
                </button>
                <button id="btn-2020-extra" class="btn-menu">
                    üìÖ Examen Extraordinario
                    <span class="badge">OPE 2020 (Examen 2022)</span>
                </button>
            </div>
        </div>

        <!-- VISTA: SELECCI√ìN DE MODALIDAD (Entrenamiento vs Examen) -->
        <div id="view-mode-selection" class="view hidden">
            <header class="view-header">
                <button id="btn-back-mode" class="btn-icon">‚¨Ö</button>
                <h2>Configura tu Test</h2>
            </header>

            <div class="card" style="text-align:center;">
                <h3 id="mode-topic-title">Tema Seleccionado</h3>
                <p>Elige c√≥mo quieres realizar este test:</p>

                <div class="mode-grid">
                    <button id="btn-mode-training" class="btn-mode">
                        <span class="icon">üèãÔ∏è‚Äç‚ôÄÔ∏è</span>
                        <strong>Entrenamiento</strong>
                        <small>Correcci√≥n inmediata. Ideal para estudiar.</small>
                    </button>
                    <button id="btn-mode-exam" class="btn-mode">
                        <span class="icon">‚è±</span>
                        <strong>Simulacro Examen</strong>
                        <small>Sin correcci√≥n hasta el final. Nota real.</small>
                    </button>
                </div>
            </div>
        </div>

        <!-- VISTA: SELECCI√ìN DE TEMAS -->
        <div id="view-topics" class="view hidden">
            <header class="view-header">
                <button id="btn-back-topics" class="btn-icon">‚¨Ö</button>
                <h2 id="topic-title">Temas</h2>
            </header>

            <div id="topics-container" class="topics-wrapper">
                <!-- Se rellena con JS: Generales y Espec√≠ficos -->
            </div>
        </div>

        <!-- VISTA: MI PROGRESO -->
        <div id="view-progress" class="view hidden">
            <header class="view-header">
                <button id="btn-back-progress" class="btn-icon">‚¨Ö</button>
                <h2>Mi Historial</h2>
            </header>

            <div class="card">
                <div style="overflow-x:auto;">
                    <table class="progress-table">
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Test</th>
                                <th>Nota</th>
                            </tr>
                        </thead>
                        <tbody id="progress-body">
                            <!-- JS -->
                        </tbody>
                    </table>
                </div>
                <button id="btn-clear-history" class="btn-small"
                    style="margin-top:15px; background:#ffeba7; color:#555;">Borrar Historial</button>
            </div>
        </div>

        <!-- VISTA: CONFIGURACI√ìN ALEATORIA -->
        <div id="view-random" class="view hidden">
            <header class="view-header">
                <button id="btn-back-random" class="btn-icon">‚¨Ö</button>
                <h2>Modo Aleatorio</h2>
            </header>
            <div class="config-box">
                <label>¬øCu√°ntas preguntas?</label>
                <input type="number" id="random-count" min="1" max="100" value="20">
                <p style="font-size:0.8rem; color:#777;">Selecciona entre 1 y 100</p>
                <br>
                <button id="btn-start-random" class="btn-primary">Continuar ‚û°</button>
            </div>
        </div>

        <!-- VISTA: JUEGO (SIMULADOR) -->
        <div id="view-game" class="view hidden">
            <header class="game-header">
                <button id="btn-quit-game" class="btn-back">‚¨Ö</button>

                <!-- NEW FEATURE: "Borrar Fallos" header button -->
                <button id="btn-clear-failures-header" class="btn-small hidden"
                    style="background-color: #f44336; color: white; display: flex; align-items: center; justify-content: center; border-radius: 4px; padding: 4px 8px; margin-left: 10px; font-weight: bold; border: 1px solid #d32f2f; cursor: pointer;">
                    üóëÔ∏è Vaciar
                </button>

                <div class="progress-container">
                    <div id="progress-bar" class="progress-bar"></div>
                </div>
                <div class="counters">
                    <button id="btn-show-grid" class="btn-small"
                        style="margin-right:10px; padding:2px 8px; font-size:1.2rem;">‚ñ¶</button>
                    <span id="question-counter">1/--</span>
                    <span id="score-badge" class="badge-score">Aciertos: 0</span>
                </div>
            </header>

            <!-- NAV GRID OVERLAY -->
            <div id="nav-grid-overlay" class="grid-overlay hidden">
                <div class="grid-content">
                    <h3>Navegaci√≥n de Preguntas (<span id="grid-total"></span>)</h3>
                    <div id="grid-buttons" class="grid-buttons-container"></div>
                    <button id="btn-close-grid" class="btn-primary" style="margin-top:20px;">Cerrar</button>
                </div>
            </div>

            <div class="card question-card">
                <div class="card-header">
                    <span id="tema-tag" class="tag">Tema</span>
                    <span id="mode-tag" class="tag"
                        style="background:#e8f5e9; color:#2e7d32; margin-left:5px;">Modo</span>
                </div>
                <div class="card-body">
                    <h2 id="pregunta-texto">Cargando...</h2>
                    <div id="opciones-container" class="options-grid"></div>
                </div>
                <div id="feedback" class="feedback hidden">
                    <p id="explicacion"></p>
                </div>
            </div>

            <div class="controls">
                <button id="btn-prev" class="btn-secondary hidden" style="margin-right:10px;">‚¨Ö Anterior</button>
                <button id="btn-next" class="btn-primary hidden">Siguiente ‚û°</button>
            </div>
        </div>

        <!-- VISTA: RESULTADOS -->
        <div id="view-results" class="view hidden">
            <div class="card" style="text-align:center;">
                <h2>Resultados</h2>
                <div class="score-circle">
                    <span id="final-score">0</span>
                    <span class="total" id="final-total">/ 0</span>
                </div>
                <p id="final-message" style="font-size:1.2rem; font-weight:bold;">¬°Bien hecho!</p>

                <div id="exam-feedback-container" class="hidden" style="text-align:left; margin-top:20px;">
                    <!-- Aqu√≠ ir√≠a el desglose si quisi√©ramos, por ahora simple -->
                </div>

                <div style="margin-top:30px; display:flex; gap:10px; justify-content:center; flex-wrap:wrap;">
                    <button id="btn-review-exam" class="btn-primary hidden" style="background:#2196f3;">üîç Todo</button>
                    <button id="btn-review-failed" class="btn-primary hidden" style="background:#ff9800;">üîç Solo
                        Fallos</button>
                    <button id="btn-clear-failures" class="btn-secondary hidden"
                        style="background:#f44336; color:white; margin-top:10px;">üóëÔ∏è Borrar Fallos Hist√≥ricos</button>
                    <button id="btn-retry" class="btn-primary" style="background:var(--secondary);">Repetir
                        Test</button>
                    <button id="btn-home-results" class="btn-primary">Volver al Men√∫</button>
                </div>
            </div>
        </div>

    </div>

    <script src="js/script.js?v=15"></script>
</body>

</html>